---
- name: check if python2 is installed
  raw: test -e /usr/bin/python
  ignore_errors: yes
  register: python2_installed
  changed_when: no
- name: install python and deps for ansible modules
  raw: dnf install -y python2 python2-dnf
  when: python2_installed.rc == 1
...
